"""
QR Code Structure and Capacity Information
"""

VERSION_CAPACITY = {
    1: 26, 2: 44, 3: 70, 4: 100, 5: 134,
    6: 172, 7: 196, 8: 242, 9: 292, 10: 346,
    11: 404, 12: 466, 13: 532, 14: 581, 15: 655,
    16: 733, 17: 815, 18: 901, 19: 991, 20: 1085,
    21: 1156, 22: 1258, 23: 1364, 24: 1474, 25: 1588,
    26: 1706, 27: 1828, 28: 1921, 29: 2051, 30: 2185,
    31: 2323, 32: 2465, 33: 2611, 34: 2761, 35: 2876,
    36: 3034, 37: 3196, 38: 3362, 39: 3532, 40: 3706,
}

DATA_CAPACITY = {
    (1, 'L'): 19, (1, 'M'): 16, (1, 'Q'): 13, (1, 'H'): 9,
    (2, 'L'): 34, (2, 'M'): 28, (2, 'Q'): 22, (2, 'H'): 16,
    (3, 'L'): 55, (3, 'M'): 44, (3, 'Q'): 34, (3, 'H'): 26,
    (4, 'L'): 80, (4, 'M'): 64, (4, 'Q'): 48, (4, 'H'): 36,
    (5, 'L'): 108, (5, 'M'): 86, (5, 'Q'): 62, (5, 'H'): 46,
    (6, 'L'): 136, (6, 'M'): 108, (6, 'Q'): 76, (6, 'H'): 60,
    (7, 'L'): 156, (7, 'M'): 124, (7, 'Q'): 88, (7, 'H'): 66,
    (8, 'L'): 194, (8, 'M'): 154, (8, 'Q'): 110, (8, 'H'): 86,
    (9, 'L'): 232, (9, 'M'): 182, (9, 'Q'): 132, (9, 'H'): 100,
    (10, 'L'): 274, (10, 'M'): 216, (10, 'Q'): 154, (10, 'H'): 122,
    (11, 'L'): 324, (11, 'M'): 254, (11, 'Q'): 180, (11, 'H'): 140,
    (12, 'L'): 370, (12, 'M'): 290, (12, 'Q'): 206, (12, 'H'): 158,
    (13, 'L'): 428, (13, 'M'): 334, (13, 'Q'): 244, (13, 'H'): 180,
    (14, 'L'): 461, (14, 'M'): 365, (14, 'Q'): 261, (14, 'H'): 197,
    (15, 'L'): 523, (15, 'M'): 415, (15, 'Q'): 295, (15, 'H'): 223,
    (16, 'L'): 589, (16, 'M'): 453, (16, 'Q'): 325, (16, 'H'): 253,
    (17, 'L'): 647, (17, 'M'): 507, (17, 'Q'): 367, (17, 'H'): 283,
    (18, 'L'): 721, (18, 'M'): 563, (18, 'Q'): 397, (18, 'H'): 313,
    (19, 'L'): 795, (19, 'M'): 627, (19, 'Q'): 445, (19, 'H'): 341,
    (20, 'L'): 861, (20, 'M'): 669, (20, 'Q'): 485, (20, 'H'): 385,
    (21, 'L'): 932, (21, 'M'): 714, (21, 'Q'): 512, (21, 'H'): 406,
    (22, 'L'): 1006, (22, 'M'): 782, (22, 'Q'): 568, (22, 'H'): 442,
    (23, 'L'): 1094, (23, 'M'): 860, (23, 'Q'): 614, (23, 'H'): 464,
    (24, 'L'): 1174, (24, 'M'): 914, (24, 'Q'): 664, (24, 'H'): 514,
    (25, 'L'): 1276, (25, 'M'): 1000, (25, 'Q'): 718, (25, 'H'): 538,
    (26, 'L'): 1370, (26, 'M'): 1062, (26, 'Q'): 754, (26, 'H'): 596,
    (27, 'L'): 1468, (27, 'M'): 1128, (27, 'Q'): 808, (27, 'H'): 628,
    (28, 'L'): 1531, (28, 'M'): 1193, (28, 'Q'): 871, (28, 'H'): 661,
    (29, 'L'): 1631, (29, 'M'): 1267, (29, 'Q'): 911, (29, 'H'): 701,
    (30, 'L'): 1735, (30, 'M'): 1373, (30, 'Q'): 985, (30, 'H'): 745,
    (31, 'L'): 1843, (31, 'M'): 1455, (31, 'Q'): 1033, (31, 'H'): 793,
    (32, 'L'): 1955, (32, 'M'): 1541, (32, 'Q'): 1115, (32, 'H'): 845,
    (33, 'L'): 2071, (33, 'M'): 1631, (33, 'Q'): 1171, (33, 'H'): 901,
    (34, 'L'): 2191, (34, 'M'): 1725, (34, 'Q'): 1231, (34, 'H'): 961,
    (35, 'L'): 2306, (35, 'M'): 1812, (35, 'Q'): 1286, (35, 'H'): 986,
    (36, 'L'): 2434, (36, 'M'): 1914, (36, 'Q'): 1354, (36, 'H'): 1054,
    (37, 'L'): 2566, (37, 'M'): 1992, (37, 'Q'): 1426, (37, 'H'): 1096,
    (38, 'L'): 2702, (38, 'M'): 2102, (38, 'Q'): 1502, (38, 'H'): 1142,
    (39, 'L'): 2812, (39, 'M'): 2216, (39, 'Q'): 1582, (39, 'H'): 1222,
    (40, 'L'): 2956, (40, 'M'): 2334, (40, 'Q'): 1666, (40, 'H'): 1276,
}

ALIGNMENT_PATTERNS = {
    1: [],
    2: [6, 18],
    3: [6, 22],
    4: [6, 26],
    5: [6, 30],
    6: [6, 34],
    7: [6, 22, 38],
    8: [6, 24, 42],
    9: [6, 26, 46],
    10: [6, 28, 50],
    11: [6, 30, 54],
    12: [6, 32, 58],
    13: [6, 34, 62],
    14: [6, 26, 46, 66],
    15: [6, 26, 48, 70],
    16: [6, 26, 50, 74],
    17: [6, 30, 54, 78],
    18: [6, 30, 56, 82],
    19: [6, 30, 58, 86],
    20: [6, 34, 62, 90],
    21: [6, 28, 50, 72, 94],
    22: [6, 26, 50, 74, 98],
    23: [6, 30, 54, 78, 102],
    24: [6, 28, 54, 80, 106],
    25: [6, 32, 58, 84, 110],
    26: [6, 30, 58, 86, 114],
    27: [6, 34, 62, 90, 118],
    28: [6, 26, 50, 74, 98, 122],
    29: [6, 30, 54, 78, 102, 126],
    30: [6, 26, 52, 78, 104, 130],
    31: [6, 30, 56, 82, 108, 134],
    32: [6, 34, 60, 86, 112, 138],
    33: [6, 30, 58, 86, 114, 142],
    34: [6, 34, 62, 90, 118, 146],
    35: [6, 30, 54, 78, 102, 126, 150],
    36: [6, 24, 50, 76, 102, 128, 154],
    37: [6, 28, 54, 80, 106, 132, 158],
    38: [6, 32, 58, 84, 110, 136, 162],
    39: [6, 26, 54, 82, 110, 138, 166],
    40: [6, 30, 58, 86, 114, 142, 170],
}


def get_version_size(version):
    return 21 + (version - 1) * 4

def get_alignment_positions(version):
    if version == 1:
        return []
    if version in ALIGNMENT_PATTERNS:
        coords = ALIGNMENT_PATTERNS[version]
    else:
        size = get_version_size(version)
        step = 4 if version < 7 else 6 if version < 14 else 8
        coords = list(range(6, size - 7, step))
        coords.append(size - 7)
    positions = []
    for row in coords:
        for col in coords:
            if (row <= 10 and col <= 10) or \
               (row <= 10 and col >= get_version_size(version) - 11) or \
               (row >= get_version_size(version) - 11 and col <= 10):
                continue
            positions.append((row, col))
    return positions

def select_version(data_length, ec_level):
    for version in range(1, 11):
        if (version, ec_level) in DATA_CAPACITY:
            if DATA_CAPACITY[(version, ec_level)] >= data_length:
                return version
    return None
